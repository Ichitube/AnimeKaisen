from aiogram import Router, F
from aiogram.types import CallbackQuery, InputMediaAnimation
from aiogram.enums import ParseMode

from keyboards.builders import inline_builder
from recycling import profile
from data import mongodb

router = Router()


@router.callback_query(F.data == "stats")
async def stats(callback: CallbackQuery):

    user_id = callback.from_user.id

    account = await mongodb.get_user(user_id)

    rank = profile.rerank(account['stats']['rank'])

    await callback.message.edit_caption(
        caption=f"ğŸ§§ Ğ Ğ°Ğ½Ğ³: <b>{rank}</b>"
                f"\n\nğŸ”¥ ĞŸĞ¾Ğ±ĞµĞ´Ñ‹: <b>{account['battle']['stats']['wins']}</b>"
                f"\nğŸ©¸ ĞĞ¸Ñ‡ÑŒĞ¸: <b>{account['battle']['stats']['ties']}</b>",

        reply_markup=inline_builder(
            ["â›©ï¸ ĞĞ°Ğ·Ğ°Ğ´"],
            ["main_page"],
            row_width=[2, 2]
        )
    )
    await callback.answer()


@router.callback_query(F.data == "battle_system")
async def ranks(callback: CallbackQuery):
    await callback.message.edit_caption(
        caption="â– ğŸ Ğ Ğ°Ğ½Ğ³Ğ¸"
                f"\nâ”€â”€ â€¢âœ§âœ§â€¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
                "<b>\n â€¢ ĞĞ¼Ğ°Ñ‚ÑÑ€Ğ°ÑÑƒ å¤©ç…§ ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ \n â”€ 600 Ğ¸ Ğ±Ğ¾Ğ»ĞµĞµ ğŸ‘‘ ĞŸĞ¾Ğ±ĞµĞ´</b>"
                "<b>\n\n â€¢ Ğ¡Ñ‘Ğ³ÑƒĞ½ å°†è» ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ \n â”€ 300 Ğ¸ Ğ±Ğ¾Ğ»ĞµĞµ ğŸ‘‘ ĞŸĞ¾Ğ±ĞµĞ´</b>"
                "<b>\n\n â€¢ Ğ¡Ğ°Ğ¼ÑƒÑ€Ğ°Ğ¹ ä¾ ğŸ–ï¸ğŸ–ï¸ \n â”€ 150 Ğ¸ Ğ±Ğ¾Ğ»ĞµĞµ ğŸ‘‘ ĞŸĞ¾Ğ±ĞµĞ´</b>"
                "<b>\n\n â€¢ Ğ Ğ¾Ğ½Ğ¸Ğ½ æµªäºº ğŸ–ï¸ \n â”€ Ğ¼ĞµĞ½ĞµĞµ 100 ğŸ‘‘ ĞŸĞ¾Ğ±ĞµĞ´</b>",
        reply_markup=inline_builder(
            ["ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´"],
            ["battle_rating"],
            row_width=[1]
        )
    )
    await callback.answer()


@router.callback_query(F.data == "battle_rating")
async def campaign_rank(callback: CallbackQuery):
    account = await mongodb.get_user(callback.from_user.id)
    rating = await mongodb.wins_rating("battle.stats.wins", account, 'ğŸ‘‘')

    media = InputMediaAnimation(media="CgACAgIAAxkBAAIVQ2XOBCFYSQfjZfxblsVAZJ3PNGQWAAKIRwAC8utxSsak7XpiV9MnNAQ")
    await callback.message.edit_media(media=media)

    await callback.message.edit_caption(
        caption=f"â–  ğŸ†  <b>Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ ÑĞ°Ğ¼Ñ‹Ñ… ÑĞ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¾Ğ²</b>"
                f"\nâ”€â”€ â€¢âœ§âœ§â€¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
                f"{rating}"
                f"\nâ”€â”€ â€¢âœ§âœ§â€¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
                f"\nğŸ‘‘ ĞŸĞ¾Ğ±ĞµĞ´Ñ‹: {account['battle']['stats']['wins']}   â˜ ï¸ ĞĞ¸Ñ‡ÑŒĞ¸: {account['battle']['stats']['ties']}",
        parse_mode=ParseMode.HTML,
        reply_markup=inline_builder(
            ["ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´", "ğŸ Ğ Ğ°Ğ½Ğ³Ğ¸"],
            ["arena", "battle_system"],
            row_width=[2])
    )
    await callback.answer()


@router.callback_query(F.data == "battle_rules")
async def arena_rules(callback: CallbackQuery):
    await callback.message.edit_caption(
        caption="<b>â– ğŸŸï¸ ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ±Ğ¸Ñ‚Ğ²Ñ‹</b>"
                "\nâ”€â”€ â€¢âœ§âœ§â€¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
                "\n\n<b>â– ğŸ’® Ğ¦ĞµĞ»ÑŒ Ğ¸Ğ³Ñ€Ñ‹:</b> ĞŸĞ¾Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ²Ğ½Ğ¸ĞºĞ° Ğ°Ñ‚Ğ°ĞºÑƒÑ ĞµĞ³Ğ¾ Ğ¸Ğ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸"
                "\n\nâš”ï¸ <b>Ğ‘Ğ¸Ñ‚Ğ²Ñ‹:</b> \n\n â€¢ ğŸ” Ğ˜Ğ³Ñ€Ğ° Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° ÑĞ¾Ğ¿ĞµÑ€Ğ½Ğ¸ĞºĞ°"
                "\n\n â€¢ ğŸ—¡ Ğ’ Ñ‚ĞµÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ±Ğ¸Ñ‚Ğ²Ñ‹ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¸ Ğ¿Ğ¾Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ½Ğ¾ Ğ°Ñ‚Ğ°ĞºÑƒĞµÑ‚ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ° Ğ¸Ğ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ½Ğ°Ğ²Ñ‹ĞºĞ¾Ğ²"
                "\n\n â€¢ â³ Ğ¥Ğ¾Ğ´ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ Ğ¸Ğ³Ñ€Ğ¾Ğº ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ½Ğ°Ñ‡Ğ°Ğ» Ğ¿Ğ¾Ğ¸ÑĞº ÑĞ¾Ğ¿ĞµÑ€Ğ½Ğ¸ĞºĞ°"
                "\n\n â€¢ ğŸ•˜ Ğ˜Ğ³Ñ€Ğ¾ĞºĞ¸ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ Ğ² Ñ‚ĞµÑ‡ĞµĞ½Ğ¸Ğ¸ 60 ÑĞµĞºÑƒĞ½Ğ´ Ğ¸Ğ½Ğ°Ñ‡Ğµ Ğ¾Ğ½Ğ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°ÑÑ‚"
                "\n\n â€¢ ğŸ’€ Ğ•ÑĞ»Ğ¸ Ñƒ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ° Ğ¾ÑÑ‚Ğ°Ğ½ĞµÑ‚ÑÑ Ğ¼ĞµĞ½ÑŒÑˆĞµ 1 â¤ï¸ Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒĞµ, Ğ¾Ğ½ Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°ĞµÑ‚ Ğ·Ğ° Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸ĞµĞ¼"
                "ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ²Ğ¾ÑĞºÑ€ĞµÑˆĞµĞ½Ğ¸Ğµ"
                "\n\n â€¢ ğŸ‘‘ Ğ—Ğ° Ğ¿Ğ¾Ğ±ĞµĞ´Ñƒ Ğ½Ğ°Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ÑÑ \n   + 100ğŸ€„ï¸ Ğ¾Ğ¿Ñ‹Ñ‚Ğ° \n   + 200ğŸ’´ Ğ´ĞµĞ½ĞµĞ³"
                "\n\n â€¢ ğŸ’€ Ğ—Ğ° Ğ¿Ğ¾Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ½Ğ°Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ÑÑ \n   + 55ğŸ€„ï¸ Ğ¾Ğ¿Ñ‹Ñ‚Ğ° \n   + 100ğŸ’´ Ğ´ĞµĞ½ĞµĞ³"
                "\n\n â€¢ â˜ ï¸ Ğ—Ğ° Ğ½Ğ¸Ñ‡ÑŒÑ Ğ½Ğ°Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ÑÑ Ğ¿Ğ¾ \n   + 80ğŸ€„ï¸ Ğ¾Ğ¿Ñ‹Ñ‚Ğ° \n   + 150ğŸ’´ Ğ´ĞµĞ½ĞµĞ³"
                "\n\n â€¢ ğŸ´â€â˜ ï¸ Ğ•ÑĞ»Ğ¸ Ğ¸Ğ³Ñ€Ğ¾Ğº ÑĞ´Ğ°ĞµÑ‚ÑÑ, Ñ‚Ğ¾ Ğ¾Ğ½ Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¸ Ğ½Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ½Ğ°Ğ³Ñ€Ğ°Ğ´Ñƒ",
        parse_mode=ParseMode.HTML,
        reply_markup=inline_builder(
            ["âš”ï¸ Ğ ÑÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¸Ğ³Ñ€Ñ‹", "ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´"],
            ["ability_rules", "arena"],
            row_width=[1, 1]
        )
    )
    await callback.answer()


@router.callback_query(F.data == "ability_rules")
async def arena_rules(callback: CallbackQuery):
    await callback.message.edit_caption(
        caption="<b>â– âš”ï¸ Ğ ÑÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¸Ğ³Ñ€Ñ‹</b>"
                "\nâ”€â”€ â€¢âœ§âœ§â€¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
                "\n<b>ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ Ğ¸Ğ¼ĞµĞµÑ‚ ÑĞ²Ğ¾Ğ¸Ñ… ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ¸ ÑÑ‚Ğ°Ñ‚Ğ¾Ğ²</b>"
                "\n\n â€¢ âœŠğŸ» <b>Ğ¡Ğ¸Ğ»Ğ°:</b> Ğ² Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¼ Ğ²Ğ»Ğ¸ÑĞµÑ‚ Ğ½Ğ° ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ â¤ï¸ Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒĞµ, ğŸ—¡ ÑƒÑ€Ğ¾Ğ½, ğŸ›¡ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹ Ğ¸ ğŸ©¸ ĞºÑ€Ğ¸Ñ‚. ÑƒÑ€Ğ¾Ğ½Ğ°"
                "\n\n â€¢ ğŸ‘£ <b>Ğ›Ğ¾Ğ²ĞºĞ¾ÑÑ‚ÑŒ:</b> Ğ² Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¼ Ğ²Ğ»Ğ¸ÑĞµÑ‚ Ğ½Ğ° ğŸ—¡ ÑƒÑ€Ğ¾Ğ½, ğŸ›¡ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹ Ğ¸ ğŸ©¸ ĞºÑ€Ğ¸Ñ‚. ÑˆĞ°Ğ½ÑĞ°"
                "\n\n â€¢ ğŸ§  <b>Ğ˜Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚:</b> Ğ² Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¼ Ğ²Ğ»Ğ¸ÑĞµÑ‚ Ğ½Ğ° ğŸ§ª Ğ¼Ğ°Ğ½Ñ‹, Ğ¸ Ğ½ĞµĞ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼ ÑÑ‚Ğ°Ñ‚Ğ°Ğ¼"
                "\n\nâ¤ï¸ Ğ—Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒĞµ Ñ€Ğ°Ğ²Ğ½ÑĞµÑ‚ÑÑ: \n100 x âœŠğŸ»Ğ¡Ğ¸Ğ»Ğ°"
                "\n\nğŸ—¡ Ğ£Ñ€Ğ¾Ğ½ Ñ€Ğ°Ğ²Ğ½ÑĞµÑ‚ÑÑ: \nâœŠğŸ»Ğ¡Ğ¸Ğ»Ğ° + ğŸ‘£Ğ›Ğ²Ğº + (ğŸ§ Ğ˜Ğ½Ñ‚ : 2)"
                "\n\nğŸ›¡ Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ñ€Ğ°Ğ²Ğ½ÑĞµÑ‚ÑÑ: \n(âœŠğŸ»Ğ¡Ğ¸Ğ»Ğ° + ğŸ‘£Ğ›Ğ²Ğº + (ğŸ§ Ğ˜Ğ½Ñ‚ : 2)) : 4"
                "\n\nğŸ§ª ĞœĞ°Ğ½Ğ° Ñ€Ğ°Ğ²Ğ½ÑĞµÑ‚ÑÑ: \n10 x ğŸ§ Ğ˜Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚"
                "\n\nğŸª« Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ Ğ½Ğ°ĞºĞ°Ğ¿Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ğ¾ 5 ĞµĞ´Ğ¸Ğ½Ğ¸Ñ† ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ â³ Ñ…Ğ¾Ğ´"
                "\n\nğŸ©¸ ĞšÑ€Ğ¸Ñ‚. ÑƒÑ€Ğ¾Ğ½: \nâœŠğŸ»Ğ¡Ğ¸Ğ»Ğ° + (ğŸ‘£Ğ›Ğ²Ğº : 2) + (ğŸ§ Ğ˜Ğ½Ñ‚ : 4)"
                "\n\nğŸ©¸ ĞšÑ€Ğ¸Ñ‚. ÑˆĞ°Ğ½Ñ: \nğŸ‘£Ğ›Ğ²Ğº + (âœŠğŸ»Ğ¡Ğ¸Ğ»Ğ° : 2) + (ğŸ§ Ğ˜Ğ½Ñ‚ : 4)"
                "\n\n<i>ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»Ğ¸ â¤ï¸ Ğ—Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ, ğŸ—¡ Ğ£Ñ€Ğ¾Ğ½Ğ°, ğŸ›¡ Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ñ‹, ğŸ§ª ĞœĞ°Ğ½Ñ‹ ÑĞ²Ğ»ÑÑÑ‚ÑÑ Ñ„Ğ¸ĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ² Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğ¸ Ğº "
                "Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğ¼ ÑÑ‚Ğ°Ñ‚Ğ°Ğ¼ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ° Ğ¿ĞµÑ€ĞµĞ´ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾Ğ¹ Ğ±Ğ¸Ñ‚Ğ²Ñ‹, Ğ° ğŸ©¸ ĞšÑ€Ğ¸Ñ‚. ÑƒÑ€Ğ¾Ğ½ Ğ¸ ğŸ©¸ ĞšÑ€Ğ¸Ñ‚. ÑˆĞ°Ğ½Ñ Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ…Ğ¾Ğ´ Ğ² "
                "Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ñ… ÑÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ°</i>",
        parse_mode=ParseMode.HTML,
        reply_markup=inline_builder(
            ["ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´"],
            ["battle_rules"],
            row_width=[2, 2]
        )
    )
    await callback.answer()

a = ("\n\n\nğŸ‘¥âš”ï¸ <b>ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ½Ñ‹Ğµ Ğ±Ğ¸Ñ‚Ğ²Ñ‹:</b> "
     "\n\n â€¢ ğŸ“‹ Ğ˜Ğ³Ñ€Ğ¾ĞºĞ¸ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ² Ğ³Ñ€ÑƒĞ¿Ğ¿Ğµ Ğ¸ Ğ¿Ğ¾ÑĞ»Ğµ Ğ´ĞµĞ»ÑÑ‚ÑÑ Ğ½Ğ° Ğ´Ğ²Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¿Ğ¾ Ñ€Ğ°Ğ²Ğ½Ğ¾Ğ¼Ñƒ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ñƒ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¾Ğ²."
     "\n\n â€¢ âœ–ï¸ Ğ•ÑĞ»Ğ¸ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¾Ğ² Ğ½ĞµÑ‡ĞµÑ‚Ğ½Ğ¾Ğµ, Ñ‚Ğ¾ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµÑˆÑŒÑÑ Ğ¸Ğ³Ñ€Ğ¾Ğº Ğ²Ñ‹Ğ±Ğ¸Ğ²Ğ°ĞµÑ‚."
     "\n\n â€¢ ğŸ©¸ Ğ˜Ğ³Ñ€Ğ° Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶ĞµÑ‚ÑÑ Ğ´Ğ¾ Ñ‚ĞµÑ… Ğ¿Ğ¾Ñ€, Ğ¿Ğ¾ĞºĞ° Ğ¾Ğ´Ğ½Ğ° Ğ¸Ğ· ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ Ğ½Ğµ Ğ¾ÑÑ‚Ğ°Ğ½ĞµÑ‚ÑÑ Ğ±ĞµĞ· Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¾Ğ². "
     "\n\n â€¢ ğŸ”¥ Ğ˜Ğ³Ñ€Ğ¾ĞºĞ¸ Ğ’Ñ‹Ğ¶Ğ¸Ğ²ÑˆĞµĞ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¿Ğ¾Ğ±ĞµĞ¶Ğ´Ğ°ÑÑ‚.")
